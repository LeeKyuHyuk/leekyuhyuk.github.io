<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta property="og:image" content="https://kyuhyuk.kr/thumbnail.png"/><title>[React] Context를 사용하여 더 효율적으로 작업해보기</title><meta name="author" content="KyuHyuk Lee"/><meta name="generator" content="KyuHyuk Lee"/><meta name="description" content=" 아래와 같은 UI가 있다고 가정해봅시다. Root의 State에 itemList 라는 값이 있고, 이 값을 변경시키는 handleSetItemList() 라는 함수가 있습니 다. 상품을 장바구니에 넣을 때, ProductItem 에서는 itemList 의 값을 바꾸기 위해 handle"/><meta itemProp="url" content="https://kyuhyuk.kr/article/react/2021/07/21/React-Context-API"/><meta itemProp="headline" content="[React] Context를 사용하여 더 효율적으로 작업해보기"/><meta property="og:type" content="article"/><meta property="og:url" content="https://kyuhyuk.kr/article/react/2021/07/21/React-Context-API"/><meta property="og:title" content="[React] Context를 사용하여 더 효율적으로 작업해보기"/><meta property="og:description" content=" 아래와 같은 UI가 있다고 가정해봅시다. Root의 State에 itemList 라는 값이 있고, 이 값을 변경시키는 handleSetItemList() 라는 함수가 있습니 다. 상품을 장바구니에 넣을 때, ProductItem 에서는 itemList 의 값을 바꾸기 위해 handle"/><meta property="og:site_name" content="KyuHyuk Blog"/><meta property="og:locale" content="ko_KR"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/4e0666c6da09e1ee.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4e0666c6da09e1ee.css" data-n-g=""/><link rel="preload" href="/_next/static/css/c2a527101433f11d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c2a527101433f11d.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2774ecbb7f55613d.js" defer=""></script><script src="/_next/static/chunks/869-82e19047d92f6e30.js" defer=""></script><script src="/_next/static/chunks/895-531271280742d591.js" defer=""></script><script src="/_next/static/chunks/pages/article/%5Bcategory%5D/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bslug%5D-e1207b3501068a48.js" defer=""></script><script src="/_next/static/Dsgna1Ug9ERZ37IDpNGla/_buildManifest.js" defer=""></script><script src="/_next/static/Dsgna1Ug9ERZ37IDpNGla/_ssgManifest.js" defer=""></script><script src="/_next/static/Dsgna1Ug9ERZ37IDpNGla/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><header class="c-opBYf"><a href="https://kyuhyuk.kr"><div class="c-bHyrwK"><div class="c-uBnvQ">Kh.</div><div class="c-hehuMV">KyuHyuk Blog</div></div></a><ul class="c-bjkCdF"><li><a href="https://github.com/LeeKyuHyuk" class="c-hAoZGi"><span role="img" aria-label="github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></span></a></li><li><a href="https://linkedin.com/in/leekyuhyuk" class="c-hAoZGi"><span role="img" aria-label="linkedin" class="anticon anticon-linkedin"><svg viewBox="64 64 896 896" focusable="false" data-icon="linkedin" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM349.3 793.7H230.6V411.9h118.7v381.8zm-59.3-434a68.8 68.8 0 1168.8-68.8c-.1 38-30.9 68.8-68.8 68.8zm503.7 434H675.1V608c0-44.3-.8-101.2-61.7-101.2-61.7 0-71.2 48.2-71.2 98v188.9H423.7V411.9h113.8v52.2h1.6c15.8-30 54.5-61.7 112.3-61.7 120.2 0 142.3 79.1 142.3 181.9v209.4z"></path></svg></span></a></li><li><a href="mailto:lee@kyuhyuk.kr" class="c-hAoZGi"><span role="img" aria-label="mail" class="anticon anticon-mail"><svg viewBox="64 64 896 896" focusable="false" data-icon="mail" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-80.8 108.9L531.7 514.4c-7.8 6.1-18.7 6.1-26.5 0L189.6 268.9A7.2 7.2 0 01194 256h648.8a7.2 7.2 0 014.4 12.9z"></path></svg></span></a></li></ul></header><main class="c-jfcKOQ"><article><h1 class="c-fxvkZv"><a href="https://kyuhyuk.kr/article/react/2021/07/21/React-Context-API">[React] Context를 사용하여 더 효율적으로 작업해보기</a></h1><a href="https://kyuhyuk.kr/category/React" class="c-iosjjB">React</a><time dateTime="2021-07-22 00:49:09" class="c-jYwCTI">Jul 22, 2021 09:49:09 AM</time><div id="post" class="c-dIcdES"><p>아래와 같은 UI가 있다고 가정해봅시다.<br>
<img src="/assets/image/2021-07-23-React-Context-API/2021-07-23-React-Context-API_1.png" alt="Example UI"></p>
<p><img src="/assets/image/2021-07-23-React-Context-API/2021-07-23-React-Context-API_2.png" alt="Example Structure"></p>
<p>Root의 State에 <code>itemList</code>라는 값이 있고, 이 값을 변경시키는 <code>handleSetItemList()</code>라는 함수가 있습니
다.<br>
상품을 장바구니에 넣을 때, <code>ProductItem</code>에서는 <code>itemList</code>의 값을 바꾸기 위해 <code>handleSetItemList()</code>를
호출하고, <code>BasketHeader</code>에서는 <code>itemList</code>의 값을 이용하여 장바구니에 몇 개가 담겼는지 표시해 줍니다
.<br>
위의 요구 사항을 구현하기 위해서는 <code>itemList</code>와 <code>handleSetItemList()</code> 함수를 Props를 사용하여 하위컴
포넌트에게 전달을 해야 합니다.</p>
<p>만약 하위 컴포넌트가 엄청 많고 복잡하다면 어떻게 해야 할까요? 계속 아래로 전달해야 할까요?</p>
<h2>React Context를 사용합시다!</h2>
<p>React 16.3부터 Context API가 추가되었으며, Context를 사용하면 더 간편하게 값을 읽고 설정할 수 있습니
다.</p>
<p>코드를 간단하게 짜보도록 하겠습니다.</p>
<p><strong>src/index.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-dom&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App&#x27;</span>;

<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>));
</code></pre>
<p><strong>src/Types.ts :</strong></p>
<pre><code class="language-ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">Item</span> = {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">price</span>: <span class="hljs-built_in">number</span>;
};
</code></pre>
<p><strong>src/App.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Content</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Content&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Header</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Header&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Content</span> /&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<p><strong>src/Header.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">BasketHeader</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./BasketHeader&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Header</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">BasketHeader</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Header</span>;
</code></pre>
<p><strong>src/BasketHeader.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">BasketHeader</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>이곳에 장바구니의 개수가 출력됩니다.<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">BasketHeader</span>;
</code></pre>
<p><strong>src/Content.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ProductList</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./ProductList&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Content</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ProductList</span> /&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Content</span>;
</code></pre>
<p><strong>src/ProductList.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ProductItem</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./ProductItem&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Item</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Types&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">ProductList</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">foods</span>: <span class="hljs-title class_">Item</span>[] = [
    { <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;탕수육&#x27;</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">10000</span> },
    { <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;마라탕&#x27;</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">7500</span> },
  ];

  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span>
      {foods.map((food, index) =&gt; {
        return <span class="hljs-tag">&lt;<span class="hljs-name">ProductItem</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span> <span class="hljs-attr">food</span>=<span class="hljs-string">{food}</span> /&gt;</span>;
      })}
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">ProductList</span>;
</code></pre>
<p><strong>src/ProductItem.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Item</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Types&#x27;</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ProductItemProps</span> = {
  <span class="hljs-attr">food</span>: <span class="hljs-title class_">Item</span>;
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">ProductItem</span> = (<span class="hljs-params">{ food }: ProductItemProps</span>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
        {food.name} - {food.price}원
      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>장바구니 담기 +<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">ProductItem</span>;
</code></pre>
<p>모두 작성했다면, 아래와 같은 화면이 출력 될 것입니다.<br>
<img src="/assets/image/2021-07-23-React-Context-API/2021-07-23-React-Context-API_3.png" alt="Example React View"></p>
<p>이 화면에서 장바구니 담기를 누르면, Console 창에 무엇이 담겼는지 출력되고 위에 장바구니 개수가 출력
되는 것을 간단하게 구현해보려고 합니다.</p>
<p><strong>src/BasketContext.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Item</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Types&#x27;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Action</span> {
  <span class="hljs-variable constant_">SET</span> = <span class="hljs-string">&#x27;SET&#x27;</span>,
}

<span class="hljs-keyword">type</span> <span class="hljs-title class_">BasketAction</span> = {
  <span class="hljs-attr">type</span>: <span class="hljs-title class_">Action</span>;
  <span class="hljs-attr">itemList</span>: <span class="hljs-title class_">Item</span>[];
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">BasketState</span> = {
  <span class="hljs-attr">itemList</span>: <span class="hljs-title class_">Item</span>[];
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">BasketDispatch</span> = <span class="hljs-title class_">React</span>.<span class="hljs-property">Dispatch</span>&lt;<span class="hljs-title class_">BasketAction</span>&gt;;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">BasketStateContext</span> = <span class="hljs-title class_">React</span>.<span class="hljs-property">createContext</span>&lt;<span class="hljs-title class_">BasketState</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">BasketDispatchContext</span> = <span class="hljs-title class_">React</span>.<span class="hljs-property">createContext</span>&lt;<span class="hljs-title class_">BasketDispatch</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> reducer = (<span class="hljs-attr">state</span>: <span class="hljs-title class_">BasketState</span>, <span class="hljs-attr">action</span>: <span class="hljs-title class_">BasketAction</span>): <span class="hljs-function"><span class="hljs-params">BasketState</span> =&gt;</span> {
  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-title class_">Action</span>.<span class="hljs-property">SET</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">itemList</span>: state.<span class="hljs-property">itemList</span>.<span class="hljs-title function_">concat</span>(action.<span class="hljs-property">itemList</span>),
      };
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Unhandled action&#x27;</span>);
  }
};
</code></pre>
<p><strong>src/BasketProvider.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BasketDispatchContext</span>, <span class="hljs-title class_">BasketStateContext</span>, reducer } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./BasketContext&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">BasketProvider</span> = (<span class="hljs-params">{ children }: { children: React.ReactNode }</span>) =&gt; {
  <span class="hljs-keyword">const</span> [state, dispatch] = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useReducer</span>(reducer, {
    <span class="hljs-attr">itemList</span>: [],
  });

  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">BasketStateContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{state}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">BasketDispatchContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{dispatch}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">BasketDispatchContext.Provider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">BasketStateContext.Provider</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">BasketProvider</span>;
</code></pre>
<p><strong>src/BasketHook.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BasketDispatchContext</span>, <span class="hljs-title class_">BasketStateContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./BasketContext&#x27;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useBasketState</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">const</span> state = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">BasketStateContext</span>);
  <span class="hljs-keyword">if</span> (!state) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Cannot find BasketProvider&#x27;</span>);
  <span class="hljs-keyword">return</span> state;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useBasketDispatch</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">const</span> dispatch = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">BasketDispatchContext</span>);
  <span class="hljs-keyword">if</span> (!dispatch) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Cannot find BasketProvider&#x27;</span>);
  <span class="hljs-keyword">return</span> dispatch;
}
</code></pre>
<p>이제 Context, Provider, Custom Hooks 모두 준비가 완료되었습니다.<br>
<code>index.tsx</code>를 아래와 같이 수정하면, <code>App</code> 컴포넌트 안에 있는 모든 곳에서 <code>state</code>와 <code>dispatch</code>를 위에
서 만든 Custom Hooks를 사용하여 쉽게 사용할 수 있습니다.</p>
<p><strong>src/index.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-dom&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">BasketProvider</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./BasketProvider&#x27;</span>;

<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(
  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">BasketProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">BasketProvider</span>&gt;</span></span>,
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>)
);
</code></pre>
<p><code>BasketHeader.tsx</code>와 <code>ProductItem.tsx</code>을 아래와 같이 수정하여, <code>itemList</code>의 값을 읽고 변경해봅시다.</p>
<p><strong>src/BasketHeader.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> { useBasketState } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./BasketHook&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">BasketHeader</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-keyword">const</span> state = <span class="hljs-title function_">useBasketState</span>();

  <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(state.<span class="hljs-property">itemList</span>);
  }, [state.<span class="hljs-property">itemList</span>]);

  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>총 {state.itemList.length}개의 상품이 담겼습니다.<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">BasketHeader</span>;
</code></pre>
<p><strong>src/ProductItem.tsx :</strong></p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Action</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./BasketContext&#x27;</span>;
<span class="hljs-keyword">import</span> { useBasketDispatch } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./BasketHook&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Item</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Types&#x27;</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ProductItemProps</span> = {
  <span class="hljs-attr">food</span>: <span class="hljs-title class_">Item</span>;
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">ProductItem</span> = (<span class="hljs-params">{ food }: ProductItemProps</span>) =&gt; {
  <span class="hljs-keyword">const</span> dispatch = <span class="hljs-title function_">useBasketDispatch</span>();

  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
        {food.name} - {food.price}원
      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
        <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span>
          dispatch({
            type: Action.SET,
            itemList: [{ name: food.name, price: food.price }],
          })
        }
      &gt;
        장바구니 담기 +
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">ProductItem</span>;
</code></pre>
<p>모두 마치셨다면, '장바구니 담기' 버튼을 눌러 확인해봅시다.<br>
<img src="/assets/image/2021-07-23-React-Context-API/2021-07-23-React-Context-API_4.png" alt="Example React View"></p>
<p>긴 글을 읽어주셔서 감사합니다.<br>
시간이 나신다면 <code>Action</code>에 'REMOVE'와 같은 여러 Action을 추가하여 여러 기능을 추가하여 더 완성도 있
게 만들어봅시다.</p>
</div></article></main><footer class="c-cpkrrK"><div class="c-fiqONv">© <!-- -->2022<!-- --></div><div class="c-bHyrwK"><div class="c-iUFgVP">Kh.</div><div class="c-cshSRb">KyuHyuk Lee</div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"excerpt":" 아래와 같은 UI가 있다고 가정해봅시다. Root의 State에 itemList 라는 값이 있고, 이 값을 변경시키는 handleSetItemList() 라는 함수가 있습니 다. 상품을 장바구니에 넣을 때, ProductItem 에서는 itemList 의 값을 바꾸기 위해 handle","url":"/article/react/2021/07/21/React-Context-API","frontmatter":{"title":"[React] Context를 사용하여 더 효율적으로 작업해보기","date":"2021-07-22 00:49:09","category":"React"},"content":"\r\n아래와 같은 UI가 있다고 가정해봅시다.  \r\n![Example UI](/assets/image/2021-07-23-React-Context-API/2021-07-23-React-Context-API_1.png)\r\n\r\n![Example Structure](/assets/image/2021-07-23-React-Context-API/2021-07-23-React-Context-API_2.png)\r\n\r\nRoot의 State에 `itemList`라는 값이 있고, 이 값을 변경시키는 `handleSetItemList()`라는 함수가 있습니\r\n다.  \r\n상품을 장바구니에 넣을 때, `ProductItem`에서는 `itemList`의 값을 바꾸기 위해 `handleSetItemList()`를\r\n호출하고, `BasketHeader`에서는 `itemList`의 값을 이용하여 장바구니에 몇 개가 담겼는지 표시해 줍니다\r\n.  \r\n위의 요구 사항을 구현하기 위해서는 `itemList`와 `handleSetItemList()` 함수를 Props를 사용하여 하위컴\r\n포넌트에게 전달을 해야 합니다.\r\n\r\n만약 하위 컴포넌트가 엄청 많고 복잡하다면 어떻게 해야 할까요? 계속 아래로 전달해야 할까요?\r\n\r\n## React Context를 사용합시다!\r\n\r\nReact 16.3부터 Context API가 추가되었으며, Context를 사용하면 더 간편하게 값을 읽고 설정할 수 있습니\r\n다.\r\n\r\n코드를 간단하게 짜보도록 하겠습니다.\r\n\r\n**src/index.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nReactDOM.render(\u003cApp /\u003e, document.getElementById('root'));\r\n```\r\n\r\n**src/Types.ts :**\r\n\r\n```ts\r\nexport type Item = {\r\n  name: string;\r\n  price: number;\r\n};\r\n```\r\n\r\n**src/App.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport Content from './Content';\r\nimport Header from './Header';\r\n\r\nconst App = () =\u003e {\r\n  return (\r\n    \u003c\u003e\r\n      \u003cHeader /\u003e\r\n      \u003cContent /\u003e\r\n    \u003c/\u003e\r\n  );\r\n};\r\n\r\nexport default App;\r\n```\r\n\r\n**src/Header.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport BasketHeader from './BasketHeader';\r\n\r\nconst Header = () =\u003e {\r\n  return (\r\n    \u003c\u003e\r\n      \u003cBasketHeader /\u003e\r\n      \u003cbr /\u003e\r\n    \u003c/\u003e\r\n  );\r\n};\r\n\r\nexport default Header;\r\n```\r\n\r\n**src/BasketHeader.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\n\r\nconst BasketHeader = () =\u003e {\r\n  return (\r\n    \u003c\u003e\r\n      \u003cspan\u003e이곳에 장바구니의 개수가 출력됩니다.\u003c/span\u003e\r\n    \u003c/\u003e\r\n  );\r\n};\r\n\r\nexport default BasketHeader;\r\n```\r\n\r\n**src/Content.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport ProductList from './ProductList';\r\n\r\nconst Content = () =\u003e {\r\n  return (\r\n    \u003c\u003e\r\n      \u003cProductList /\u003e\r\n    \u003c/\u003e\r\n  );\r\n};\r\n\r\nexport default Content;\r\n```\r\n\r\n**src/ProductList.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport ProductItem from './ProductItem';\r\nimport { Item } from './Types';\r\n\r\nconst ProductList = () =\u003e {\r\n  const foods: Item[] = [\r\n    { name: '탕수육', price: 10000 },\r\n    { name: '마라탕', price: 7500 },\r\n  ];\r\n\r\n  return (\r\n    \u003c\u003e\r\n      {foods.map((food, index) =\u003e {\r\n        return \u003cProductItem key={index} food={food} /\u003e;\r\n      })}\r\n    \u003c/\u003e\r\n  );\r\n};\r\n\r\nexport default ProductList;\r\n```\r\n\r\n**src/ProductItem.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport { Item } from './Types';\r\n\r\ntype ProductItemProps = {\r\n  food: Item;\r\n};\r\n\r\nconst ProductItem = ({ food }: ProductItemProps) =\u003e {\r\n  return (\r\n    \u003c\u003e\r\n      \u003cp\u003e\r\n        {food.name} - {food.price}원\r\n      \u003c/p\u003e\r\n      \u003cbutton\u003e장바구니 담기 +\u003c/button\u003e\r\n    \u003c/\u003e\r\n  );\r\n};\r\n\r\nexport default ProductItem;\r\n```\r\n\r\n모두 작성했다면, 아래와 같은 화면이 출력 될 것입니다.  \r\n![Example React View](/assets/image/2021-07-23-React-Context-API/2021-07-23-React-Context-API_3.png)\r\n\r\n이 화면에서 장바구니 담기를 누르면, Console 창에 무엇이 담겼는지 출력되고 위에 장바구니 개수가 출력\r\n되는 것을 간단하게 구현해보려고 합니다.\r\n\r\n**src/BasketContext.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport { Item } from './Types';\r\n\r\nexport enum Action {\r\n  SET = 'SET',\r\n}\r\n\r\ntype BasketAction = {\r\n  type: Action;\r\n  itemList: Item[];\r\n};\r\n\r\ntype BasketState = {\r\n  itemList: Item[];\r\n};\r\n\r\ntype BasketDispatch = React.Dispatch\u003cBasketAction\u003e;\r\n\r\nexport const BasketStateContext = React.createContext\u003cBasketState | null\u003e(null);\r\nexport const BasketDispatchContext = React.createContext\u003cBasketDispatch | null\u003e(null);\r\n\r\nexport const reducer = (state: BasketState, action: BasketAction): BasketState =\u003e {\r\n  switch (action.type) {\r\n    case Action.SET:\r\n      return {\r\n        ...state,\r\n        itemList: state.itemList.concat(action.itemList),\r\n      };\r\n    default:\r\n      throw new Error('Unhandled action');\r\n  }\r\n};\r\n```\r\n\r\n**src/BasketProvider.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport { BasketDispatchContext, BasketStateContext, reducer } from './BasketContext';\r\n\r\nconst BasketProvider = ({ children }: { children: React.ReactNode }) =\u003e {\r\n  const [state, dispatch] = React.useReducer(reducer, {\r\n    itemList: [],\r\n  });\r\n\r\n  return (\r\n    \u003cBasketStateContext.Provider value={state}\u003e\r\n      \u003cBasketDispatchContext.Provider value={dispatch}\u003e{children}\u003c/BasketDispatchContext.Provider\u003e\r\n    \u003c/BasketStateContext.Provider\u003e\r\n  );\r\n};\r\n\r\nexport default BasketProvider;\r\n```\r\n\r\n**src/BasketHook.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport { BasketDispatchContext, BasketStateContext } from './BasketContext';\r\n\r\nexport function useBasketState() {\r\n  const state = React.useContext(BasketStateContext);\r\n  if (!state) throw new Error('Cannot find BasketProvider');\r\n  return state;\r\n}\r\n\r\nexport function useBasketDispatch() {\r\n  const dispatch = React.useContext(BasketDispatchContext);\r\n  if (!dispatch) throw new Error('Cannot find BasketProvider');\r\n  return dispatch;\r\n}\r\n```\r\n\r\n이제 Context, Provider, Custom Hooks 모두 준비가 완료되었습니다.  \r\n`index.tsx`를 아래와 같이 수정하면, `App` 컴포넌트 안에 있는 모든 곳에서 `state`와 `dispatch`를 위에\r\n서 만든 Custom Hooks를 사용하여 쉽게 사용할 수 있습니다.\r\n\r\n**src/index.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport BasketProvider from './BasketProvider';\r\n\r\nReactDOM.render(\r\n  \u003cBasketProvider\u003e\r\n    \u003cApp /\u003e\r\n  \u003c/BasketProvider\u003e,\r\n  document.getElementById('root')\r\n);\r\n```\r\n\r\n`BasketHeader.tsx`와 `ProductItem.tsx`을 아래와 같이 수정하여, `itemList`의 값을 읽고 변경해봅시다.\r\n\r\n**src/BasketHeader.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport { useBasketState } from './BasketHook';\r\n\r\nconst BasketHeader = () =\u003e {\r\n  const state = useBasketState();\r\n\r\n  React.useEffect(() =\u003e {\r\n    console.log(state.itemList);\r\n  }, [state.itemList]);\r\n\r\n  return (\r\n    \u003c\u003e\r\n      \u003cspan\u003e총 {state.itemList.length}개의 상품이 담겼습니다.\u003c/span\u003e\r\n    \u003c/\u003e\r\n  );\r\n};\r\n\r\nexport default BasketHeader;\r\n```\r\n\r\n**src/ProductItem.tsx :**\r\n\r\n```tsx\r\nimport * as React from 'react';\r\nimport { Action } from './BasketContext';\r\nimport { useBasketDispatch } from './BasketHook';\r\nimport { Item } from './Types';\r\n\r\ntype ProductItemProps = {\r\n  food: Item;\r\n};\r\n\r\nconst ProductItem = ({ food }: ProductItemProps) =\u003e {\r\n  const dispatch = useBasketDispatch();\r\n\r\n  return (\r\n    \u003c\u003e\r\n      \u003cp\u003e\r\n        {food.name} - {food.price}원\r\n      \u003c/p\u003e\r\n      \u003cbutton\r\n        onClick={() =\u003e\r\n          dispatch({\r\n            type: Action.SET,\r\n            itemList: [{ name: food.name, price: food.price }],\r\n          })\r\n        }\r\n      \u003e\r\n        장바구니 담기 +\r\n      \u003c/button\u003e\r\n    \u003c/\u003e\r\n  );\r\n};\r\n\r\nexport default ProductItem;\r\n```\r\n\r\n모두 마치셨다면, '장바구니 담기' 버튼을 눌러 확인해봅시다.  \r\n![Example React View](/assets/image/2021-07-23-React-Context-API/2021-07-23-React-Context-API_4.png)\r\n\r\n긴 글을 읽어주셔서 감사합니다.  \r\n시간이 나신다면 `Action`에 'REMOVE'와 같은 여러 Action을 추가하여 여러 기능을 추가하여 더 완성도 있\r\n게 만들어봅시다.\r\n"},"__N_SSG":true},"page":"/article/[category]/[year]/[month]/[day]/[slug]","query":{"category":"react","year":"2021","month":"07","day":"21","slug":"React-Context-API"},"buildId":"Dsgna1Ug9ERZ37IDpNGla","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>