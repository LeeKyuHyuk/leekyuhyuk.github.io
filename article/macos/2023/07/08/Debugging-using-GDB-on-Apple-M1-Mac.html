<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><style id="stitches"></style><link rel="preload" href="/_next/static/css/98b299b94b0a7962.css" as="style"/><link rel="stylesheet" href="/_next/static/css/98b299b94b0a7962.css" data-n-g=""/><link rel="preload" href="/_next/static/css/5c3da54741072322.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5c3da54741072322.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-dea678fb5840c50f.js" defer=""></script><script src="/_next/static/chunks/framework-64ad27b21261a9ce.js" defer=""></script><script src="/_next/static/chunks/main-f2f237ba7e9012fc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9b6890f28bc766f1.js" defer=""></script><script src="/_next/static/chunks/803-9fe1c131242daf24.js" defer=""></script><script src="/_next/static/chunks/785-d1ab2e5b6dacd475.js" defer=""></script><script src="/_next/static/chunks/pages/article/%5Bcategory%5D/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bslug%5D-6501b82d330bbee5.js" defer=""></script><script src="/_next/static/dFiaKGJXnX9ZfXI4gZrP9/_buildManifest.js" defer=""></script><script src="/_next/static/dFiaKGJXnX9ZfXI4gZrP9/_ssgManifest.js" defer=""></script></head><body><div id="__next"></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"excerpt":" M1이 탑재된 macOS(Ventura 13.4.1)에서 GDB을 사용할 수 없어서 어떻게 하면 사용할 수 있을지 고민하다가 Docker를 사용하여 GDB를 사용하는 방법을 공유합니다. Visual Studio Code의 Remote SSH를 사용하는 방법 Install Docker ","url":"/article/macos/2023/07/08/Debugging-using-GDB-on-Apple-M1-Mac","frontmatter":{"title":"Apple M1 Mac에서 GDB를 사용하여 디버깅을 해보자","date":"2023-07-08 02:10:31","category":"macOS"},"content":"\nM1이 탑재된 macOS(Ventura 13.4.1)에서 GDB을 사용할 수 없어서 어떻게 하면 사용할 수 있을지 고민하다가 Docker를 사용하여 GDB를 사용하는 방법을 공유합니다.\n\n# Visual Studio Code의 Remote SSH를 사용하는 방법\n\n[Install Docker Desktop on Mac](https://docs.docker.com/desktop/install/mac-install)에 접속하여 Docker를 다운로드하여 설치합니다.\n\n아래와 같이 `Dockerfile`과 `build.sh`를 생성하고 아래와 같이 작성합니다.  \n\n**`Dockerfile` :**  \n`root`와 사용자(`code`)의 비밀번호는 `code`로 설정했습니다.  \n```dockerfile\nFROM debian:12.0-slim\n\nENV DEBIAN_FRONTEND noninteractive\nENV TZ=Asia/Seoul\n\nUSER root\nRUN apt-get update \\\n    \u0026\u0026 apt-get upgrade -y -q \\\n    \u0026\u0026 apt-get install -y -q --no-install-recommends ca-certificates cmake curl g++ gcc gdb git gnupg2 make openssh-server sudo zsh \\\n    \u0026\u0026 apt-get clean \\\n    \u0026\u0026 rm -r /var/lib/apt/lists/*\nRUN echo 'root:code' | chpasswd\nRUN mkdir -pv /home/code\nRUN useradd code -d /home/code -s /usr/bin/zsh \u0026\u0026 echo 'code:code' | chpasswd\nRUN chown code:code /home/code\nRUN echo \"code\tALL=(ALL:ALL)\tALL\" \u003e\u003e /etc/sudoers\nRUN /usr/bin/ssh-keygen -A\nRUN sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/g' /etc/ssh/sshd_config\nRUN echo \"#!/bin/sh\" \u003e /usr/sbin/run_sshd.sh\nRUN echo \"service ssh restart \u0026\u0026 /bin/sh\" \u003e\u003e /usr/sbin/run_sshd.sh\nUSER code\nRUN sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"\nUSER root\n\nEXPOSE 22\n\nCMD [\"/bin/sh\", \"/usr/sbin/run_sshd.sh\"]\n```\n\n**`build.sh` :**  \n```sh\n#!/bin/sh\n/Applications/Docker.app/Contents/Resources/bin/docker build -t vscode-ssh-server:1.0.0 .\n/Applications/Docker.app/Contents/Resources/bin/docker run --name vscode-ssh-server --cap-add=SYS_PTRACE --security-opt=\"seccomp=unconfined\" --tmpfs /tmp -d -dit -p 22:22 -i -t --restart always vscode-ssh-server:1.0.0\n```\n\n모두 작성하고 `build.sh`를 실행하면 됩니다.  \nDocker Container가 생성되면 Visual Studio Code의 Remote SSH를 사용하여 `code@localhost -p 22`에 접근하여 사용하면 됩니다.  \n![GDB Debugging](/assets/image/2023-07-08-Debugging-using-GDB-on-Apple-M1-Mac/2023-07-08-Debugging-using-GDB-on-Apple-M1-Mac_5.png)\n\n\n# [code-server](https://github.com/coder/code-server)를 사용하는 방법\n\n[Install Docker Desktop on Mac](https://docs.docker.com/desktop/install/mac-install)에 접속하여 Docker를 다운로드하여 설치합니다.\n\n아래와 같이 `Dockerfile`과 `build.sh`를 생성하고 아래와 같이 작성합니다.  \n![Dockerfile](/assets/image/2023-07-08-Debugging-using-GDB-on-Apple-M1-Mac/2023-07-08-Debugging-using-GDB-on-Apple-M1-Mac_1.png)  \n**`Dockerfile` :**  \n`root`와 사용자(`code`)의 비밀번호는 `code`로 설정했습니다.  \n```dockerfile\nFROM fedora:38\n\nENV TZ=Asia/Seoul\n\nUSER root\nRUN dnf upgrade -y --refresh\nRUN dnf install -y bash cmake curl dnf-utils g++ gcc gdb git glibc-static gnupg2 libstdc++-static passwd wget\nRUN curl -fsSL https://code-server.dev/install.sh | sh\nRUN dnf clean all\nRUN rm -rf /var/cache/yum\nRUN echo code | passwd root --stdin\nRUN useradd code -G wheel \u0026\u0026 echo code | passwd code --stdin\nRUN echo \"code\tALL=(ALL:ALL)\tALL\" \u003e\u003e /etc/sudoers\nUSER code\nRUN mkdir -p /home/code/.config/code-server\nRUN echo \"bind-addr: 0.0.0.0:8080\" \u003e /home/code/.config/code-server/config.yaml\nRUN echo \"auth: password\" \u003e\u003e /home/code/.config/code-server/config.yaml\nRUN echo \"password: code\" \u003e\u003e /home/code/.config/code-server/config.yaml\nRUN echo \"cert: false\" \u003e\u003e /home/code/.config/code-server/config.yaml\nRUN echo \"#!/bin/sh\" \u003e /home/code/.config/code-server/run.sh\nRUN echo \"/usr/bin/code-server \u0026\" \u003e\u003e /home/code/.config/code-server/run.sh\nRUN echo \"while true ; do\" \u003e\u003e /home/code/.config/code-server/run.sh\nRUN echo \"  sleep 3600;\" \u003e\u003e /home/code/.config/code-server/run.sh\nRUN echo \"done\" \u003e\u003e /home/code/.config/code-server/run.sh\n\nEXPOSE 8080\nCMD [\"/bin/sh\", \"/home/code/.config/code-server/run.sh\"]\n```\n\n**`build.sh` :**  \n```sh\n#!/bin/sh\n/Applications/Docker.app/Contents/Resources/bin/docker build -t code-server:1.0.0 .\n/Applications/Docker.app/Contents/Resources/bin/docker run --name code-server --cap-add=SYS_PTRACE --security-opt=\"seccomp=unconfined\" --tmpfs /tmp -d -dit -p 8080:8080 -i -t --restart always code-server:1.0.0\n```\n\n모두 작성하고 `build.sh`를 실행하면 됩니다.\n\n그리고 아래의 링크를 클릭하여 C/C++ Visual Studio Code Extension의 VSIX 파일을 다운로드 합니다.\n- [C/C++](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools)\n- [C/C++ Themes](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools-themes)\n- [CMake](https://marketplace.visualstudio.com/items?itemName=twxs.cmake)\n- [CMake Tools](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cmake-tools)\n\n'Download Extension'을 클릭했을 때 아래와 같이 출력된다면, Linux ARM64로 다운로드하면 됩니다.\n![C/C++ Visual Studio Code Extension Download](/assets/image/2023-07-08-Debugging-using-GDB-on-Apple-M1-Mac/2023-07-08-Debugging-using-GDB-on-Apple-M1-Mac_2.png)\n\n[http://localhost:8080](http://localhost:8080)에 접속하여 VSIX 파일을 설치합니다. **(code-server의 암호는 `code` 입니다)**\n![C/C++ Visual Studio Code Extension Install](/assets/image/2023-07-08-Debugging-using-GDB-on-Apple-M1-Mac/2023-07-08-Debugging-using-GDB-on-Apple-M1-Mac_3.png)\n\n프로젝트를 열고 Breakpoint를 설정한 뒤, Debug 버튼을 클릭해 보면 아래와 같이 GDB가 정상적으로 작동되는 것을 확인할 수 있습니다.\n![GDB Debugging](/assets/image/2023-07-08-Debugging-using-GDB-on-Apple-M1-Mac/2023-07-08-Debugging-using-GDB-on-Apple-M1-Mac_4.png)"},"__N_SSG":true},"page":"/article/[category]/[year]/[month]/[day]/[slug]","query":{"category":"macos","year":"2023","month":"07","day":"08","slug":"Debugging-using-GDB-on-Apple-M1-Mac"},"buildId":"dFiaKGJXnX9ZfXI4gZrP9","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>